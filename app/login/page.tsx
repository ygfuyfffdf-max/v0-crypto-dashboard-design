/**
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 * üåå CHRONOS LOGIN PAGE ‚Äî SILVER SPACE PREMIUM EDITION
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 *
 * P√°gina de login premium con:
 * - Animaci√≥n KOCMOC Silver Space (logo orbital)
 * - Part√≠culas de plata espacial de alta calidad
 * - Integraci√≥n con Clerk para autenticaci√≥n
 * - Colores: Plata/Negro/Blanco √∫nicamente
 *
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 */

'use client'

import { AnimatePresence, motion } from 'motion/react'
import { useRouter } from 'next/navigation'
import { useCallback, useEffect, useState } from 'react'
import dynamic from 'next/dynamic'

// Auth Gateway integrado con Clerk
import { KocmocLoginForm } from '@/app/_components/auth/KocmocAuthGateway'

// KOCMOC Premium System - Silver Space
const SilverSpaceCinematic = dynamic(
  () => import('@/app/_components/cinematics/KocmocPremiumSystem').then((mod) => mod.SilverSpaceCinematic),
  { ssr: false }
)

const SilverDustBackground = dynamic(
  () => import('@/app/_components/cinematics/KocmocPremiumSystem').then((mod) => mod.SilverDustBackground),
  { ssr: false }
)

const KocmocLogoPremium = dynamic(
  () => import('@/app/_components/cinematics/KocmocPremiumSystem').then((mod) => mod.KocmocLogoPremium),
  { ssr: false }
)

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MAIN LOGIN PAGE - SILVER SPACE EDITION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

export default function LoginPage() {
  const router = useRouter()
  const [showIntro, setShowIntro] = useState(true)
  const [isReady, setIsReady] = useState(false)

  // Verificar si ya se mostr√≥ la animaci√≥n de intro en esta sesi√≥n
  useEffect(() => {
    const hasSeenIntro = sessionStorage.getItem('kocmoc-intro-v4')
    if (hasSeenIntro) {
      setShowIntro(false)
      setIsReady(true)
    }
  }, [])

  const handleIntroComplete = useCallback(() => {
    sessionStorage.setItem('kocmoc-intro-v4', 'true')
    setShowIntro(false)
    setTimeout(() => setIsReady(true), 100)
  }, [])

  const handleSuccess = useCallback(() => {
    router.push('/dashboard')
  }, [router])

  const handleSignUpClick = useCallback(() => {
    router.push('/register')
  }, [router])

  return (
    <div className="relative min-h-screen overflow-hidden bg-black">
      {/* Cinematogr√°fica de Intro - KOCMOC Silver Space */}
      <AnimatePresence mode="wait">
        {showIntro && (
          <SilverSpaceCinematic
            onComplete={handleIntroComplete}
            duration={6000}
            showChronos={true}
          />
        )}
      </AnimatePresence>

      {/* Contenido principal - Login con fondo de part√≠culas */}
      <AnimatePresence>
        {!showIntro && isReady && (
          <motion.div
            className="relative min-h-screen flex items-center justify-center"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ duration: 1, ease: [0.16, 1, 0.3, 1] }}
          >
            {/* Fondo de part√≠culas Silver Dust */}
            <SilverDustBackground
              particleCount={100}
              interactive={true}
              intensity="medium"
              className="z-0"
            />

            {/* Logo en header */}
            <motion.div
              className="absolute top-8 left-1/2 -translate-x-1/2 z-20"
              initial={{ opacity: 0, y: -20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3, duration: 0.8 }}
            >
              <KocmocLogoPremium
                size={120}
                animated={true}
                showText={true}
                animationPhase="complete"
              />
            </motion.div>

            {/* Formulario de Login con Clerk */}
            <div className="relative z-10 w-full px-4 pt-32 pb-8">
              <KocmocLoginForm
                onSuccess={handleSuccess}
                onSignUpClick={handleSignUpClick}
              />
            </div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  )
}
